<body id="category">
    <!-- Start Banner Area -->
    <section class="banner-area organic-breadcrumb">
        <div class="container">
            <div class="breadcrumb-banner d-flex flex-wrap align-items-center justify-content-end">
                <!-- Content here -->
            </div>
        </div>
    </section>
    <!-- End Banner Area -->
    <div class="container">
        <div class="row">
            <div class="col-xl-3 col-lg-4 col-md-5">
                <div class="sidebar-categories">
                    <div class="head">Categories</div>
                    <ul class="main-categories">
                        <li class="main-nav-list">
                            <a data-toggle="collapse" href="#fruitsVegetable" aria-expanded="false" aria-controls="fruitsVegetable">
                                <span class="lnr lnr-arrow-right"></span>Sports Shoes<span class="number">(53)</span>
                            </a>
                            <ul class="collapse" id="fruitsVegetable" data-toggle="collapse" aria-expanded="false" aria-controls="fruitsVegetable">
                                <li class="main-nav-list child">
                                    <a href="javascript:void(0);" id="running-link" onclick="setTypeFilter('running')">Running Shoes<span class="number">(13)</span></a>
                                </li>
                                <li class="main-nav-list child">
                                    <a href="javascript:void(0);" id="basketball-link" onclick="setTypeFilter('basketball')">Basketball Shoes<span class="number">(09)</span></a>
                                </li>
                                <li class="main-nav-list child">
                                    <a href="javascript:void(0);" id="tennis-link" onclick="setTypeFilter('tennis')">Tennis Shoes<span class="number">(17)</span></a>
                                </li>
                                <li class="main-nav-list child">
                                    <a href="javascript:void(0);" id="walking-link" onclick="setTypeFilter('walking')">Walking Shoes<span class="number">(11)</span></a>
                                </li>
                            </ul>
                        </li>
                        <!-- Other categories go here -->
						<li class="main-nav-list"><a data-toggle="collapse" href="#meatFish" aria-expanded="false" aria-controls="meatFish"><span
								 class="lnr lnr-arrow-right"></span>Leather Shoes<span class="number">(53)</span></a>
							<ul class="collapse" id="meatFish" data-toggle="collapse" aria-expanded="false" aria-controls="meatFish">
                                <li class="main-nav-list child">
                                    <a href="javascript:void(0);" id="mens-dress-link" onclick="setTypeFilter('mens-dress')">Men’s Dress Shoes<span class="number">(13)</span></a>
                                </li>
                                <li class="main-nav-list child">
                                    <a href="javascript:void(0);" id="loafers-link" onclick="setTypeFilter('loafers')">Loafers<span class="number">(09)</span></a>
                                </li>
                                <li class="main-nav-list child">
                                    <a href="javascript:void(0);" id="high-top-link" onclick="setTypeFilter('high-top')">High-Top Shoes<span class="number">(17)</span></a>
                                </li>
                                <li class="main-nav-list child">
                                    <a href="javascript:void(0);" id="boots-link" onclick="setTypeFilter('boots')">Boots<span class="number">(01)</span></a>
                                </li>
                                <li class="main-nav-list child">
                                    <a href="javascript:void(0);" id="womens-leather-link" onclick="setTypeFilter('womens-leather')">Women’s Leather Shoes<span class="number">(11)</span></a>
                                </li>
                         </ul>

						
						</li>
						<li class="main-nav-list"><a data-toggle="collapse" href="#cooking" aria-expanded="false" aria-controls="cooking"><span
								 class="lnr lnr-arrow-right"></span>Sneakers<span class="number">(53)</span></a>
						<ul class="collapse" id="cooking" data-toggle="collapse" aria-expanded="false" aria-controls="cooking">
                            <li class="main-nav-list child">
                                <a href="javascript:void(0);" onclick="setTypeFilter('sports-sneakers')>Sports Sneakers<span class="number">(13)</span></a>
                            </li>
                            <li class="main-nav-list child">
                                <a href="javascript:void(0);" onclick="setTypeFilter('fashion-sneakers')>Fashion Sneakers<span class="number">(09)</span></a>
                            </li>
                            <li class="main-nav-list child">
                                <a href="javascript:void(0);" onclick="setTypeFilter('classic-sneakers')>Classic Sneakers<span class="number">(17)</span></a>
                            </li>
                            <li class="main-nav-list child">
                                <a href="javascript:void(0);" onclick="setTypeFilter('special-edition-sneakers')>Special Edition Sneakers<span class="number">(01)</span></a>
                            </li>
                        </ul>

						</li>
					
						<li class="main-nav-list"><a data-toggle="collapse" href="#beverages" aria-expanded="false" aria-controls="beverages"><span
								 class="lnr lnr-arrow-right"></span>Women’s Shoes<span class="number">(24)</span></a>
						<ul class="collapse" id="beverages" data-toggle="collapse" aria-expanded="false" aria-controls="beverages">
                            <li class="main-nav-list child">
                                <a href="javascript:void(0);" onclick="setTypeFilter('high-heels')">High Heels<span class="number">(13)</span></a>
                            </li>
                            <li class="main-nav-list child">
                                <a href="javascript:void(0);" onclick="setTypeFilter('flats')">Flats<span class="number">(09)</span></a>
                            </li>
                            <li class="main-nav-list child">
                                <a href="javascript:void(0);" onclick="setTypeFilter('sandals')">Sandals<span class="number">(17)</span></a>
                            </li>
                            <li class="main-nav-list child">
                                <a href="javascript:void(0);" onclick="setTypeFilter('womens-boots')">Women’s Boots<span class="number">(01)</span></a>
                            </li>
                        </ul>

						</li>
						<li class="main-nav-list"><a data-toggle="collapse" href="#homeClean" aria-expanded="false" aria-controls="homeClean"><span
								 class="lnr lnr-arrow-right"></span>Kids’ Shoes<span class="number">(53)</span></a>
						<ul class="collapse" id="homeClean" data-toggle="collapse" aria-expanded="false" aria-controls="homeClean">
                            <li class="main-nav-list child">
                                <a href="javascript:void(0);" onclick="setTypeFilter('boys-shoes')">Boys’ Shoes<span class="number">(13)</span></a>
                            </li>
                            <li class="main-nav-list child">
                                <a href="javascript:void(0);" onclick="setTypeFilter('girls-shoes')">Girls’ Shoes<span class="number">(09)</span></a>
                            </li>
                            <li class="main-nav-list child">
                                <a href="javascript:void(0);" onclick="setTypeFilter('kids-sports-shoes')">Kids’ Sports Shoes<span class="number">(17)</span></a>
                            </li>
                            <li class="main-nav-list child">
                                <a href="javascript:void(0);" onclick="setTypeFilter('kids-sandals')">Kids’ Sandals<span class="number">(01)</span></a>
                            </li>
                        </ul>

						</li>
					</ul>
						</div>
				<div class="sidebar-filter mt-50">
					<div class="top-filter-head">Product Filters</div>
					<div class="common-filter">
						 <div class="head">Brands</div>
                        <ul>
                            <li class="filter-list">
                                <input class="pixel-checkbox" type="checkbox" id="addidas" name="brand" value="Addidas">
                                <label for="addidas">Addidas<span>(29)</span></label>
                            </li>
                            <li class="filter-list">
                                <input class="pixel-checkbox" type="checkbox" id="ananas" name="brand" value="Ananas">
                                <label for="ananas">Ananas<span>(29)</span></label>
                            </li>
                            <li class="filter-list">
                                <input class="pixel-checkbox" type="checkbox" id="nike" name="brand" value="Nike">
                                <label for="nike">Nike<span>(19)</span></label>
                            </li>
                            <li class="filter-list">
                                <input class="pixel-checkbox" type="checkbox" id="convert" name="brand" value="Convert">
                                <label for="convert">Convert<span>(19)</span></label>
                            </li>
                            <li class="filter-list">
                                <input class="pixel-checkbox" type="checkbox" id="puma" name="brand" value="Puma">
                                <label for="puma">Puma<span>(19)</span></label>
                            </li>
                        </ul>
                </div>
					<div class="common-filter">
						<div class="head">Color</div>
						<form action="#">
						    <ul>
                                <li class="filter-list">
                                    <input class="pixel-checkbox" type="checkbox" id="black" name="color" value="Black">
                                    <label for="black">Black<span>(29)</span></label>
                                </li>
                                <li class="filter-list">
                                    <input class="pixel-checkbox" type="checkbox" id="blackleather" name="color" value="Black Leather">
                                    <label for="blackleather">Black Leather<span>(29)</span></label>
                                </li>
                                <li class="filter-list">
                                    <input class="pixel-checkbox" type="checkbox" id="blackred" name="color" value="Black with Red">
                                    <label for="blackred">Black with Red<span>(19)</span></label>
                                </li>
                                <li class="filter-list">
                                    <input class="pixel-checkbox" type="checkbox" id="gold" name="color" value="Gold">
                                    <label for="gold">Gold<span>(19)</span></label>
                                </li>
                                <li class="filter-list">
                                    <input class="pixel-checkbox" type="checkbox" id="spacegrey" name="color" value="Spacegrey">
                                    <label for="spacegrey">Spacegrey<span>(19)</span></label>
                                </li>
                            </ul>

						</form>
					</div>
					<div class="common-filter">
						<div class="head">Price</div>
						<div class="price-range-area">
							<div id="price-range"></div>
							<div class="value-wrapper d-flex">
								<div class="price">Price:</div>
								<span>$</span>
								<div id="lower-value"></div>
								<div class="to">to</div>
								<span>$</span>
								<div id="upper-value"></div>
							</div>
						</div>
					</div>
				</div>
			

               
                <!-- Additional filters go here -->
            </div>

            <div class="col-xl-9 col-lg-8 col-md-7">
                <!-- Start Filter Bar -->
                <div class="filter-bar d-flex flex-wrap align-items-center">
                    <div class="sorting">
                        <select>
                            <option value="1">Default sorting</option>
                            <option value="2">Price</option>
                            <option value="3">Popularity</option>
                        </select>
                    </div>
                    <div class="sorting mr-auto">
                        <select>
                            <option value="1">Show 12</option>
                            <option value="2">Show 24</option>
                            <option value="3">Show 36</option>
                        </select>
                    </div>
                    <div class="pagination">
                        <a href="#" class="prev-arrow"><i class="fa fa-long-arrow-left" aria-hidden="true"></i></a>
                        <a href="#" class="active">1</a>
                        <a href="#">2</a>
                        <a href="#">3</a>
                        <a href="#" class="dot-dot"><i class="fa fa-ellipsis-h" aria-hidden="true"></i></a>
                        <a href="#">6</a>
                        <a href="#" class="next-arrow"><i class="fa fa-long-arrow-right" aria-hidden="true"></i></a>
                    </div>
                </div>
                <!-- End Filter Bar -->

                <!-- Start Product List -->
                <section class="lattest-product-area pb-40 category-list">
                    <div class="row" id="product-list">
                        {{#each products}}
                        <div class="col-lg-4 col-md-6">
                            <div class="single-product">
                                <a href="/product/product-details/{{this._id}}">
                                    <img class="img-fluid" src="/{{this.image}}" alt="{{this.name}}">
                                </a>
                                <div class="product-details">
                                    <a href="/product/product-details/{{this._id}}">
                                        <h6>{{this.name}}</h6>
                                    </a>
                                    <div class="price">
                                        <h6>${{this.price}}</h6>
                                        <h6 class="l-through">$210.00</h6>
                                        <h6>${{this.type}}</h6>
                                    </div>
                                    <div class="prd-bottom">
                                        <a href="" class="social-info">
                                            <span class="ti-bag"></span>
                                            <p class="hover-text">add to bag</p>
                                        </a>
                                        <a href="" class="social-info">
                                            <span class="lnr lnr-heart"></span>
                                            <p class="hover-text">Wishlist</p>
                                        </a>
                                        <a href="" class="social-info">
                                            <span class="lnr lnr-sync"></span>
                                            <p class="hover-text">compare</p>
                                        </a>
                                        <a href="/product/product-details/{{this._id}}" class="social-info">
                                            <span class="lnr lnr-move"></span>
                                            <p class="hover-text">view more</p>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {{/each}}
                    </div>
                </section>
                <!-- End Product List -->

                <!-- Start Filter Bar -->
                <div class="filter-bar d-flex flex-wrap align-items-center">
                    <div class="sorting mr-auto">
                        <select>
                            <option value="1">Show 12</option>
                            <option value="2">Show 24</option>
                            <option value="3">Show 36</option>
                        </select>
                    </div>
                    <div class="pagination">
                        <a href="#" class="prev-arrow"><i class="fa fa-long-arrow-left" aria-hidden="true"></i></a>
                        <a href="#" class="active">1</a>
                        <a href="#">2</a>
                        <a href="#">3</a>
                        <a href="#" class="dot-dot"><i class="fa fa-ellipsis-h" aria-hidden="true"></i></a>
                        <a href="#">6</a>
                        <a href="#" class="next-arrow"><i class="fa fa-long-arrow-right" aria-hidden="true"></i></a>
                    </div>
                </div>
                <!-- End Filter Bar -->
            </div>
        </div>
    </div>

    <!-- Start related-product Area -->
    <section class="related-product-area section_gap">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-6 text-center">
                    <div class="section-title">
                        <h1>Deals of the Week</h1>
                        <p>Our exclusive deal that helps you enjoy life to the fullest and in style!</p>
                    </div>
                </div>
            </div>
            <!-- Additional content here -->
        </div>
    </section>
    <!-- End related-product Area -->
<script>
    let filters = {};

    function setTypeFilter(type) {
        filters.type = [type]; // Gán type mới
        applyFilters(); // Áp dụng tất cả bộ lọc
        setActiveCategory(type);
        filterProducts(type);
    }
    function setActiveCategory(type) {
        
        // Xóa class 'active' từ tất cả danh mục
        const categoryLinks = document.querySelectorAll('.main-nav-list.child a');
        categoryLinks.forEach(link => {
            if (link.classList.contains('active')) {
                link.classList.remove('active');
            }
        });
        // Thêm class 'active' vào danh mục được chọn
        const activeLink = document.getElementById(`${type}-link`);
        if (activeLink) {
            activeLink.classList.add('active');
        }
    }

    function applyFilters() {
        
        // Thu thập giá trị cho từng loại lọc
        filters.brand = getCheckedValues('brand');
        filters.color = getCheckedValues('color');
        
        const minPrice = document.getElementById('lower-value')?.textContent;
        const maxPrice = document.getElementById('upper-value')?.textContent;

        if (minPrice) filters.minPrice = minPrice;
        if (maxPrice) filters.maxPrice = maxPrice;

        // Gọi API lọc
        filterProducts(filters);
    }

    // Hàm lấy tất cả giá trị được chọn
    function getCheckedValues(name) {
        const checkboxes = document.querySelectorAll(`input[name="${name}"]:checked`);
        return Array.from(checkboxes).map(checkbox => checkbox.value);
    }

    // Hàm gửi request với tất cả các bộ lọc
    function filterProducts(filters) {
        console.log(filters);
        const query = new URLSearchParams(filters).toString();
        fetch(`/product/filter?${query}`)
            .then(response => response.json())
            .then(data => {
                updateProductList(data.products);
            })
            .catch(error => console.error('Error:', error));
    }

    // Hàm để cập nhật danh sách sản phẩm
    function updateProductList(products) {
        const productList = document.getElementById('product-list');
        productList.innerHTML = ''; // Xóa các sản phẩm hiện có

        // Render sản phẩm được lọc
        products.forEach(product => {
            productList.innerHTML += `
                <div class="col-lg-4 col-md-6">
                    <div class="single-product">
                        <a href="/product/product-details/${product._id}">
                            <img class="img-fluid" src="/${product.image}" alt="${product.name}">
                        </a>
                        <div class="product-details">
                            <a href="/product/product-details/${product._id}">
                                <h6>${product.name}</h6>
                            </a>
                            <div class="price">
                                <h6>$${product.price}</h6>
                            </div>
                            <div class="prd-bottom">
                                <a href="" class="social-info">
                                    <span class="ti-bag"></span>
                                    <p class="hover-text">add to bag</p>
                                </a>
                                <a href="" class="social-info">
                                    <span class="lnr lnr-heart"></span>
                                    <p class="hover-text">Wishlist</p>
                                </a>
                                <a href="" class="social-info">
                                    <span class="lnr lnr-sync"></span>
                                    <p class="hover-text">compare</p>
                                </a>
                                <a href="/product/product-details/${product._id}" class="social-info">
                                    <span class="lnr lnr-move"></span>
                                    <p class="hover-text">view more</p>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        });
    }
    // Gắn sự kiện tự động gọi applyFilters khi có thay đổi
    document.addEventListener('DOMContentLoaded', function () {
        document.querySelectorAll('input[name="type"], input[name="brand"], input[name="color"]').forEach(input => {
        input.addEventListener('change', applyFilters);
    });

    });

</script>
</body>
